(function(b){'use strict';var a={videoMaxWidth:'855px',youtubePlayerParams:!1,vimeoPlayerParams:!1,dailymotionPlayerParams:!1,vkPlayerParams:!1,videojs:!1},c=function(c){return this.core=b(c).data('lightGallery'),this.$el=b(c),this.core.s=b.extend({},a,this.core.s),this.videoLoaded=!1,this.init(),this};c.prototype.init=function(){var a=this;a.core.$el.on('hasVideo.lg.tm',function(b,c,d,e){if(a.core.$slide.eq(c).find('.lg-video').append(a.loadVideo(d,'lg-object',!0,c,e)),e)if(a.core.s.videojs)try{videojs(a.core.$slide.eq(c).find('.lg-html5').get(0),{},function(){a.videoLoaded||this.play()})}catch(a){console.error('Make sure you have included videojs')}else a.core.$slide.eq(c).find('.lg-html5').get(0).play()}),a.core.$el.on('onAferAppendSlide.lg.tm',function(b,c){a.core.$slide.eq(c).find('.lg-video-cont').css('max-width',a.core.s.videoMaxWidth),a.videoLoaded=!0});var c=function(b){if(b.find('.lg-object').hasClass('lg-has-poster')&&b.find('.lg-object').is(':visible'))if(!b.hasClass('lg-has-video')){b.addClass('lg-video-playing lg-has-video');var c,d,e=function(c,d){if(b.find('.lg-video').append(a.loadVideo(c,'',!1,a.core.index,d)),d)if(a.core.s.videojs)try{videojs(a.core.$slide.eq(a.core.index).find('.lg-html5').get(0),{},function(){this.play()})}catch(a){console.error('Make sure you have included videojs')}else a.core.$slide.eq(a.core.index).find('.lg-html5').get(0).play()};a.core.s.dynamic?(c=a.core.s.dynamicEl[a.core.index].src,d=a.core.s.dynamicEl[a.core.index].html,e(c,d)):(c=a.core.$items.eq(a.core.index).attr('href')||a.core.$items.eq(a.core.index).attr('data-src'),d=a.core.$items.eq(a.core.index).attr('data-html'),e(c,d));var f=b.find('.lg-object');b.find('.lg-video').append(f),b.find('.lg-video-object').hasClass('lg-html5')||(b.removeClass('lg-complete'),b.find('.lg-video-object').on('load.lg error.lg',function(){b.addClass('lg-complete')}))}else{var g=b.find('.lg-youtube').get(0),h=b.find('.lg-vimeo').get(0),i=b.find('.lg-dailymotion').get(0),j=b.find('.lg-html5').get(0);if(g)g.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}','*');else if(h)try{$f(h).api('play')}catch(a){console.error('Make sure you have included froogaloop2 js')}else if(i)i.contentWindow.postMessage('play','*');else if(j)if(a.core.s.videojs)try{videojs(j).play()}catch(a){console.error('Make sure you have included videojs')}else j.play();b.addClass('lg-video-playing')}};a.core.doCss()&&1<a.core.$items.length&&(a.core.s.enableSwipe&&a.core.isTouch||a.core.s.enableDrag&&!a.core.isTouch)?a.core.$el.on('onSlideClick.lg.tm',function(){var b=a.core.$slide.eq(a.core.index);c(b)}):a.core.$slide.on('click.lg',function(){c(b(this))}),a.core.$el.on('onBeforeSlide.lg.tm',function(c,d,e){var f=a.core.$slide.eq(d),g=f.find('.lg-youtube').get(0),h=f.find('.lg-vimeo').get(0),i=f.find('.lg-dailymotion').get(0),j=f.find('.lg-vk').get(0),k=f.find('.lg-html5').get(0);if(g)g.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}','*');else if(h)try{$f(h).api('pause')}catch(a){console.error('Make sure you have included froogaloop2 js')}else if(i)i.contentWindow.postMessage('pause','*');else if(k)if(a.core.s.videojs)try{videojs(k).pause()}catch(a){console.error('Make sure you have included videojs')}else k.pause();j&&b(j).attr('src',b(j).attr('src').replace('&autoplay','&noplay'));var l=a.core.s.dynamic?a.core.s.dynamicEl[e].src:a.core.$items.eq(e).attr('href')||a.core.$items.eq(e).attr('data-src');var m=a.core.isVideo(l,e)||{};(m.youtube||m.vimeo||m.dailymotion||m.vk)&&a.core.$outer.addClass('lg-hide-download')}),a.core.$el.on('onAfterSlide.lg.tm',function(b,c){a.core.$slide.eq(c).removeClass('lg-video-playing')})},c.prototype.loadVideo=function(c,d,e,f,g){var h='',i=1,j='',a=this.core.isVideo(c,f)||{};if(e&&(this.videoLoaded?i=0:i=1),a.youtube)j='?wmode=opaque&autoplay='+i+'&enablejsapi=1',this.core.s.youtubePlayerParams&&(j=j+'&'+b.param(this.core.s.youtubePlayerParams)),h='<iframe class="lg-video-object lg-youtube '+d+'" width="560" height="315" src="//www.youtube.com/embed/'+a.youtube[1]+j+'" frameborder="0" allowfullscreen></iframe>';else if(a.vimeo)j='?autoplay='+i+'&api=1',this.core.s.vimeoPlayerParams&&(j=j+'&'+b.param(this.core.s.vimeoPlayerParams)),h='<iframe class="lg-video-object lg-vimeo '+d+'" width="560" height="315"  src="//player.vimeo.com/video/'+a.vimeo[1]+j+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';else if(a.dailymotion)j='?wmode=opaque&autoplay='+i+'&api=postMessage',this.core.s.dailymotionPlayerParams&&(j=j+'&'+b.param(this.core.s.dailymotionPlayerParams)),h='<iframe class="lg-video-object lg-dailymotion '+d+'" width="560" height="315" src="//www.dailymotion.com/embed/video/'+a.dailymotion[1]+j+'" frameborder="0" allowfullscreen></iframe>';else if(a.html5){var k=g.substring(0,1);('.'===k||'#'===k)&&(g=b(g).html()),h=g}else a.vk&&(j='&autoplay='+i,this.core.s.vkPlayerParams&&(j=j+'&'+b.param(this.core.s.vkPlayerParams)),h='<iframe class="lg-video-object lg-vk '+d+'" width="560" height="315" src="http://vk.com/video_ext.php?'+a.vk[1]+j+'" frameborder="0" allowfullscreen></iframe>');return h},c.prototype.destroy=function(){this.videoLoaded=!1},b.fn.lightGallery.modules.video=c})(jQuery,window,document);